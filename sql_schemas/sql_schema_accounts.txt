BEGIN TRANSACTION;

DROP TABLE IF EXISTS "users";
CREATE TABLE IF NOT EXISTS "users" (
 "id" INTEGER PRIMARY KEY AUTOINCREMENT,
 "username" INTEGER NOT NULL UNIQUE,
 "email" TEXT NOT NULL UNIQUE,
 "token" TEXT NOT NULL,
 "num_login" INTEGER NOT NULL DEFAULT 0,
 "last_login" TEXT
);

DROP TABLE IF EXISTS "user_details";
CREATE TABLE IF NOT EXISTS "user_details" (
 "user_id" INTEGER NOT NULL UNIQUE,
 "first_name" TEXT NOT NULL,
 "last_name" TEXT NOT NULL,
 "is_academics" INTEGER NOT NULL,
 "job_title" TEXT,
 "country" TEXT NOT NULL,
 "have_nih_funding" INTEGER NOT NULL,
 "have_nsf_funding" INTEGER NOT NULL,
 "have_other_funding" INTEGER NOT NULL,
 FOREIGN KEY("user_id") REFERENCES users("id"),
 FOREIGN KEY("job_title") REFERENCES job_titles("code"),
 FOREIGN KEY("country") REFERENCES countries("code")
);

DROP TABLE IF EXISTS "job_titles";
CREATE TABLE IF NOT EXISTS "job_titles" (
 "id" INTEGER PRIMARY KEY AUTOINCREMENT,
 "name" TEXT NOT NULL
);
INSERT OR IGNORE INTO job_titles(name) VALUES('Professor');
INSERT OR IGNORE INTO job_titles(name) VALUES('Associate Professor');
INSERT OR IGNORE INTO job_titles(name) VALUES('Assistant Professor');
INSERT OR IGNORE INTO job_titles(name) VALUES('Staff Scientist');
INSERT OR IGNORE INTO job_titles(name) VALUES('Post-doc');
INSERT OR IGNORE INTO job_titles(name) VALUES('Ph.D. Student');
INSERT OR IGNORE INTO job_titles(name) VALUES('Master Student');
INSERT OR IGNORE INTO job_titles(name) VALUES('Undergrad Student');
INSERT OR IGNORE INTO job_titles(name) VALUES('Others');

DROP TABLE IF EXISTS "countries";
CREATE TABLE IF NOT EXISTS "countries" (
 "code" TEXT PRIMARY KEY,
 "name" TEXT NOT NULL,
 "lat" REAL NOT NULL,
 "long" REAL NOT NULL,
 "continent" TEXT NOT NULL
);

COMMIT;